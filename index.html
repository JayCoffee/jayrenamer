<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ•ã‚¡ã‚¤ãƒ«åã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #a8e6cf 0%, #b8f3d8 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.6rem;
            font-weight: 600;
            margin-bottom: 24px;
            color: #3d9970;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
            font-size: 0.95rem;
        }

        input[type="text"], textarea, select {
            width: 100%;
            padding: 14px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 15px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #3d9970;
        }

        select {
            cursor: pointer;
        }

        .result-box {
            background: #f0f9f4;
            padding: 20px;
            border-radius: 8px;
            margin-top: 24px;
            border: 2px solid #3d9970;
        }

        .result-label {
            font-weight: 600;
            color: #3d9970;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .result-filename {
            font-family: 'Courier New', monospace;
            font-size: 1.3rem;
            color: #2c3e50;
            padding: 12px;
            background: white;
            border-radius: 6px;
            word-break: break-all;
            min-height: 50px;
            display: flex;
            align-items: center;
        }

        .btn {
            background: linear-gradient(135deg, #4a90e2 0%, #5da3f5 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
            margin-top: 12px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-copy {
            background: linear-gradient(135deg, #3d9970 0%, #2ecc71 100%);
            margin-top: 12px;
        }

        .btn-copy:hover {
            box-shadow: 0 6px 20px rgba(61, 153, 112, 0.4);
        }

        .helper-text {
            font-size: 0.85rem;
            color: #888;
            margin-top: 6px;
            font-style: italic;
        }

        .pattern-preview {
            background: #fff3cd;
            padding: 12px;
            border-radius: 6px;
            margin-top: 8px;
            font-size: 0.9rem;
            color: #856404;
            font-family: 'Courier New', monospace;
        }

        .input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        @media (max-width: 768px) {
            .input-grid {
                grid-template-columns: 1fr;
            }
        }

        .custom-rule-section {
            background: white;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-top: 30px;
        }

        .divider {
            height: 1px;
            background: #e0e0e0;
            margin: 30px 0;
        }

        .saved-rules {
            margin-top: 20px;
        }

        .rule-item {
            background: #f9f9f9;
            padding: 14px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #3d9970;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .rule-info {
            flex: 1;
        }

        .rule-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .rule-pattern {
            font-family: 'Courier New', monospace;
            color: #666;
            font-size: 0.85rem;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            width: auto;
            margin: 0 4px;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 12px;
            border-radius: 6px;
            margin-top: 12px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«åã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
            <p class="subtitle">å‘½åè¦å‰‡ã«å¾“ã£ãŸãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç°¡å˜ã«ä½œæˆ</p>
        </header>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³: ãƒ•ã‚¡ã‚¤ãƒ«åç”Ÿæˆ -->
        <div class="card">
            <h2 class="card-title">ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ä½œæˆ</h2>
            
            <div class="form-group">
                <label for="ruleSelect">å‘½åè¦å‰‡ã‚’é¸æŠ</label>
                <select id="ruleSelect" onchange="updatePattern()">
                    <optgroup label="ä¸€èˆ¬çš„ãªè¦å‰‡">
                        <option value="date_name">æ—¥ä»˜_ãƒ•ã‚¡ã‚¤ãƒ«å (2025-10-20_report)</option>
                        <option value="project_date">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå_æ—¥ä»˜ (MyProject_2025-10-20)</option>
                        <option value="category_date_counter">ã‚«ãƒ†ã‚´ãƒª_æ—¥ä»˜_é€£ç•ª (Document_2025-10-20_001)</option>
                        <option value="date_time_name">æ—¥ä»˜æ™‚åˆ»_ãƒ•ã‚¡ã‚¤ãƒ«å (20251020_143045_report)</option>
                        <option value="project_category_date">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ_ã‚«ãƒ†ã‚´ãƒª_æ—¥ä»˜ (MyProject_Document_2025-10-20)</option>
                        <option value="yyyymmdd_counter">YYYYMMDD_é€£ç•ª (20251020_001)</option>
                    </optgroup>
                    <optgroup label="ã‚«ã‚¹ã‚¿ãƒ è¦å‰‡" id="customRulesGroup"></optgroup>
                </select>
                <div class="pattern-preview" id="patternPreview">ãƒ‘ã‚¿ãƒ¼ãƒ³: {date}_{name}</div>
            </div>

            <div class="input-grid">
                <div class="form-group">
                    <label for="fileName">ãƒ•ã‚¡ã‚¤ãƒ«å</label>
                    <input type="text" id="fileName" placeholder="report" oninput="generateFilename()">
                </div>
                <div class="form-group">
                    <label for="fileExt">æ‹¡å¼µå­</label>
                    <input type="text" id="fileExt" placeholder=".pdf" oninput="generateFilename()">
                </div>
            </div>

            <div class="input-grid">
                <div class="form-group">
                    <label for="projectName">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</label>
                    <input type="text" id="projectName" placeholder="MyProject" oninput="generateFilename()">
                </div>
                <div class="form-group">
                    <label for="categoryName">ã‚«ãƒ†ã‚´ãƒªï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</label>
                    <input type="text" id="categoryName" placeholder="Document" oninput="generateFilename()">
                </div>
            </div>

            <div class="form-group">
                <label for="counterNum">é€£ç•ªï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</label>
                <input type="text" id="counterNum" placeholder="1" oninput="generateFilename()">
                <div class="helper-text">æ•°å­—ã‚’å…¥åŠ›ã™ã‚‹ã¨è‡ªå‹•çš„ã«3æ¡ï¼ˆ001, 002...ï¼‰ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚Œã¾ã™</div>
            </div>

            <div class="result-box">
                <div class="result-label">ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«å:</div>
                <div class="result-filename" id="resultFilename">ãƒ•ã‚¡ã‚¤ãƒ«åãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>
            </div>

            <button class="btn btn-copy" onclick="copyToClipboard()">ğŸ“‹ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼</button>
            <div class="success-message" id="successMessage">âœ“ ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ!</div>
        </div>

        <!-- ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ä½œæˆ -->
        <div class="custom-rule-section">
            <h2 class="card-title">ã‚«ã‚¹ã‚¿ãƒ è¦å‰‡ã‚’ä½œæˆ</h2>
            
            <div class="form-group">
                <label for="customRuleName">è¦å‰‡å</label>
                <input type="text" id="customRuleName" placeholder="ä¾‹: ä¼šè­°è­°äº‹éŒ²ç”¨">
            </div>

            <div class="form-group">
                <label for="customPattern">ãƒ‘ã‚¿ãƒ¼ãƒ³</label>
                <input type="text" id="customPattern" placeholder="ä¾‹: {project}_{date}_{name}">
                <div class="helper-text">
                    ä½¿ç”¨å¯èƒ½: {date}, {time}, {name}, {counter}, {project}, {category}, {ext}
                </div>
            </div>

            <button class="btn" onclick="saveCustomRule()">è¦å‰‡ã‚’ä¿å­˜</button>

            <div class="saved-rules" id="savedRules"></div>
        </div>
    </div>

    <script>
        const defaultPatterns = {
            'date_name': '{date}_{name}{ext}',
            'project_date': '{project}_{date}{ext}',
            'category_date_counter': '{category}_{date}_{counter}{ext}',
            'date_time_name': '{datecompact}_{timecompact}_{name}{ext}',
            'project_category_date': '{project}_{category}_{date}{ext}',
            'yyyymmdd_counter': '{datecompact}_{counter}{ext}'
        };

        let customRules = [];

        function updatePattern() {
            const select = document.getElementById('ruleSelect');
            const value = select.value;
            let pattern = '';

            if (defaultPatterns[value]) {
                pattern = defaultPatterns[value];
            } else {
                const rule = customRules.find(r => r.id == value);
                if (rule) pattern = rule.pattern;
            }

            document.getElementById('patternPreview').textContent = 'ãƒ‘ã‚¿ãƒ¼ãƒ³: ' + pattern;
            generateFilename();
        }

        function generateFilename() {
            const select = document.getElementById('ruleSelect');
            const value = select.value;
            let pattern = '';

            if (defaultPatterns[value]) {
                pattern = defaultPatterns[value];
            } else {
                const rule = customRules.find(r => r.id == value);
                if (rule) pattern = rule.pattern;
            }

            if (!pattern) {
                document.getElementById('resultFilename').textContent = 'ãƒ•ã‚¡ã‚¤ãƒ«åãŒè¡¨ç¤ºã•ã‚Œã¾ã™';
                return;
            }

            const date = new Date();
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            const seconds = String(date.getSeconds()).padStart(2, '0');

            const name = document.getElementById('fileName').value || 'filename';
            const ext = document.getElementById('fileExt').value || '';
            const project = document.getElementById('projectName').value || 'Project';
            const category = document.getElementById('categoryName').value || 'Category';
            const counter = document.getElementById('counterNum').value || '1';
            const counterFormatted = String(counter).padStart(3, '0');

            const result = pattern
                .replace(/{date}/g, `${year}-${month}-${day}`)
                .replace(/{datecompact}/g, `${year}${month}${day}`)
                .replace(/{time}/g, `${hours}-${minutes}-${seconds}`)
                .replace(/{timecompact}/g, `${hours}${minutes}${seconds}`)
                .replace(/{name}/g, name)
                .replace(/{ext}/g, ext)
                .replace(/{project}/g, project)
                .replace(/{category}/g, category)
                .replace(/{counter}/g, counterFormatted);

            document.getElementById('resultFilename').textContent = result;
        }

        function copyToClipboard() {
            const text = document.getElementById('resultFilename').textContent;
            if (text === 'ãƒ•ã‚¡ã‚¤ãƒ«åãŒè¡¨ç¤ºã•ã‚Œã¾ã™') {
                alert('ã¾ãšãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç”Ÿæˆã—ã¦ãã ã•ã„');
                return;
            }

            navigator.clipboard.writeText(text).then(() => {
                const msg = document.getElementById('successMessage');
                msg.style.display = 'block';
                setTimeout(() => {
                    msg.style.display = 'none';
                }, 2000);
            });
        }

        function saveCustomRule() {
            const name = document.getElementById('customRuleName').value.trim();
            const pattern = document.getElementById('customPattern').value.trim();

            if (!name || !pattern) {
                alert('è¦å‰‡åã¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            const rule = {
                id: Date.now(),
                name: name,
                pattern: pattern
            };

            customRules.push(rule);
            saveToMemory();
            renderCustomRules();

            document.getElementById('customRuleName').value = '';
            document.getElementById('customPattern').value = '';

            alert('ã‚«ã‚¹ã‚¿ãƒ è¦å‰‡ã‚’ä¿å­˜ã—ã¾ã—ãŸ!');
        }

        function renderCustomRules() {
            const container = document.getElementById('savedRules');
            const optgroup = document.getElementById('customRulesGroup');

            if (customRules.length === 0) {
                container.innerHTML = '';
                optgroup.innerHTML = '';
                return;
            }

            container.innerHTML = '<div class="divider"></div><h3 style="margin-bottom: 16px; color: #3d9970;">ä¿å­˜æ¸ˆã¿ã‚«ã‚¹ã‚¿ãƒ è¦å‰‡</h3>' + 
                customRules.map(rule => `
                    <div class="rule-item">
                        <div class="rule-info">
                            <div class="rule-name">${rule.name}</div>
                            <div class="rule-pattern">${rule.pattern}</div>
                        </div>
                        <div>
                            <button class="btn btn-small" style="background: linear-gradient(135deg, #4a90e2 0%, #5da3f5 100%);" onclick="useCustomRule(${rule.id})">ä½¿ç”¨</button>
                            <button class="btn btn-small" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);" onclick="deleteCustomRule(${rule.id})">å‰Šé™¤</button>
                        </div>
                    </div>
                `).join('');

            optgroup.innerHTML = customRules.map(rule => 
                `<option value="${rule.id}">${rule.name}</option>`
            ).join('');
        }

        function useCustomRule(id) {
            document.getElementById('ruleSelect').value = id;
            updatePattern();
        }

        function deleteCustomRule(id) {
            if (confirm('ã“ã®è¦å‰‡ã‚’å‰Šé™¤ã—ã¾ã™ã‹?')) {
                customRules = customRules.filter(r => r.id !== id);
                saveToMemory();
                renderCustomRules();
                updatePattern();
            }
        }

        function saveToMemory() {
            window.customRulesData = JSON.stringify(customRules);
        }

        function loadFromMemory() {
            if (window.customRulesData) {
                customRules = JSON.parse(window.customRulesData);
                renderCustomRules();
            }
        }

        // åˆæœŸåŒ–
        loadFromMemory();
        updatePattern();
        generateFilename();
    </script>
</body>
</html>
